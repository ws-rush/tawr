(function(r,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("react/jsx-runtime"),require("valtio"),require("derive-valtio"),require("react")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","valtio","derive-valtio","react"],s):(r=typeof globalThis<"u"?globalThis:r||self,s(r.TawrState={},r.jsxRuntime,r.valtio,r.deriveValtio,r.react))})(this,function(r,s,g,u,v){"use strict";function w(c){const{state:n,getters:a,actions:p}=c,e=g.proxy(n()),S=new Set;if(a){const i=a(e);u.derive(i,{proxy:e}),e.$underive=o=>{o&&o.length>0?u.underive(e,{keys:o.map(String),delete:!0}):u.underive(e)},e.$invalidate=o=>{if(o&&o.length>0){u.underive(e,{keys:o.map(String),delete:!0});const l={};for(const h of o)l[h]=i[h];u.derive(l,{proxy:e})}else u.underive(e),u.derive(i,{proxy:e})}}if(e.$onAction=i=>(S.add(i),()=>{S.delete(i)}),p){const i={};for(const[o,l]of Object.entries(p)){const h=(...x)=>{let y=[],b=[];const T={name:o,store:e,args:x,after:t=>{y.push(t)},onError:t=>{b.push(t)}};S.forEach(t=>{t(T)});let d;try{return d=l.apply(e,x),d instanceof Promise?d.then(t=>(y.forEach(f=>f(t)),t)).catch(t=>{throw b.forEach(f=>f(t)),t}):(y.forEach(t=>t(d)),d)}catch(t){throw b.forEach(f=>f(t)),t}};i[o]=h}Object.defineProperty(e,"actions",{value:i,enumerable:!0,configurable:!0}),Object.assign(e,i)}return e}const E=c=>g.useSnapshot(c);class j extends v.Component{constructor(n){super(n),this.state={error:null}}static getDerivedStateFromError(n){return{error:n}}componentDidCatch(n,a){console.error("Error caught by boundary:",n,a)}render(){return this.state.error?this.props.fallback(this.state.error):this.props.children}}function A({resolve:c,children:n}){const a=v.use(c);return s.jsx(s.Fragment,{children:n(a)})}function C({resolve:c,fallback:n=null,error:a=m=>s.jsxs("div",{children:["Error: ",m.message]}),children:p}){return s.jsx(j,{fallback:a,children:s.jsx(v.Suspense,{fallback:n,children:s.jsx(A,{resolve:c,children:p})})})}r.Awaitable=C,r.defineStore=w,r.useSnapshot=E,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});
