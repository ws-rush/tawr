(function(o,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("react/jsx-runtime"),require("valtio"),require("derive-valtio"),require("react")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","valtio","derive-valtio","react"],i):(o=typeof globalThis<"u"?globalThis:o||self,i(o.TawrState={},o.jsxRuntime,o.valtio,o.deriveValtio,o.react))})(this,function(o,i,w,d,v){"use strict";function E(u){const{state:n,getters:a,actions:f}=u,e=w.proxy(n()),p=new Set;if(a){const c=a(e);d.derive(c,{proxy:e}),e.$underive=s=>{s&&s.length>0?d.underive(e,{keys:s.map(String),delete:!0}):d.underive(e)},e.$invalidate=s=>{if(s&&s.length>0){d.underive(e,{keys:s.map(String),delete:!0});const y={};for(const S of s)y[S]=c[S];d.derive(y,{proxy:e})}else d.underive(e),d.derive(c,{proxy:e})}}if(e.$onAction=c=>(p.add(c),()=>{p.delete(c)}),f){const c={};for(const[s,y]of Object.entries(f)){const S=(...x)=>{let m=[],g=[];const O={name:s,store:e,args:x,after:r=>{m.push(r)},onError:r=>{g.push(r)}};p.forEach(r=>{r(O)});let l;try{return l=y.apply(e,x),l instanceof Promise?l.then(r=>(m.forEach(h=>h(r)),r)).catch(r=>{throw g.forEach(h=>h(r)),r}):(m.forEach(r=>r(l)),l)}catch(r){throw g.forEach(h=>h(r)),r}};c[s]=S}Object.defineProperty(e,"actions",{value:c,enumerable:!0,configurable:!0})}return e}const A=u=>{const n=w.useSnapshot(u),a=t=>t&&typeof t=="object"&&"toISOString"in t&&"getTime"in t,f=t=>{if(!t||typeof t!="object")return t;if(a(t))return new Date(t.valueOf());if(Array.isArray(t))return t.map(f);const e={...t};for(const p in e)e[p]=f(e[p]);return e};return f(n)};class C extends v.Component{constructor(n){super(n),this.state={error:null}}static getDerivedStateFromError(n){return{error:n}}componentDidCatch(n,a){console.error("Error caught by boundary:",n,a)}render(){return this.state.error?this.props.fallback(this.state.error):this.props.children}}function T({resolve:u,children:n}){const a=v.use(u);return i.jsx(i.Fragment,{children:n(a)})}function D({resolve:u,fallback:n=null,error:a=t=>i.jsxs("div",{children:["Error: ",t.message]}),children:f}){return i.jsx(C,{fallback:a,children:i.jsx(v.Suspense,{fallback:n,children:i.jsx(T,{resolve:u,children:f})})})}o.Awaitable=D,o.defineStore=E,o.useSnapshot=A,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
