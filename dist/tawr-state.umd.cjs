(function(a,l){typeof exports=="object"&&typeof module<"u"?l(exports,require("valtio")):typeof define=="function"&&define.amd?define(["exports","valtio"],l):(a=typeof globalThis<"u"?globalThis:a||self,l(a.TawrState={},a.valtio))})(this,function(a,l){"use strict";const w={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},m=new WeakMap;function b(d,p,c){const o=m.get(d);(w?"production":void 0)!=="production"&&!o&&console.warn("Please use proxy object");let i;const u=[],s=o[2];let n=!1;const t=s(e=>{u.push(e),i||(i=Promise.resolve().then(()=>{i=void 0,n&&p(u.splice(0))}))});return n=!0,()=>{n=!1,t()}}let S;function y(d,p){let c=!0;const o=new Set,i=new Map,u=()=>{c&&(c=!1,o.forEach(n=>n()),o.clear(),i.forEach(n=>n()),i.clear())},s=async()=>{if(!c)return;o.forEach(t=>t()),o.clear();const n=new Set,r=S;S=o;try{const t=d(f=>{if(n.add(f),c&&!i.has(f)){const v=b(f,s,p==null?void 0:p.sync);i.set(f,v)}return f}),e=t&&t instanceof Promise?await t:t;e&&(c?o.add(e):u())}finally{S=r}i.forEach((t,e)=>{n.has(e)||(i.delete(e),t())})};return S&&S.add(u),s(),u}const _={use:d=>{}};async function E(d){const{state:p,getters:c,actions:o}=d,i=await p(),s=l.proxy(i);if(c){const n=c(s),r=new Map;for(const t in n){const e=n[t],f=y(v=>{const h=e(v);s[t]!==h&&(s[t]=h)});r.set(t,f)}Object.assign(s,{$underive(t){for(const e of t)r.has(e)&&(r.get(e)(),r.delete(e))},$invalidate(t){for(const e of t){r.has(e)&&(r.get(e)(),r.delete(e));const f=n[e],v=y(h=>{const g=f(h);s[e]!==g&&(s[e]=g)});r.set(e,v)}}})}return o&&Object.assign(s,o),s}Object.defineProperty(a,"useSnapshot",{enumerable:!0,get:()=>l.useSnapshot}),a.defineStore=E,a.tawr=_,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
